{
   "extendsPage": null,
   "pageRoles": [{
      "allow": true,
      "roleName": "WTAILORADMIN"
   }],
   "fileTimestamp": "2016-04-25T10:00:47Z",
   "modelView": {
      "title": "Associate Roles with a Page",
      "scriptingLanguage": "JavaScript",
      "name": "pbadmPageRoles",
      "documentation": "Associate Roles with a Page",
      "label": "Page Roles",
      "components": [
         {
            "staticData": [],
            "name": "pageRoles",
            "resource": "virtualDomains.pbadmPageRoles",
            "type": "resource"
         },
         {
            "name": "pageLookup",
            "resource": "virtualDomains.pbadmPageLookup",
            "type": "resource"
         },
         {
            "name": "webTailorRolesLookup",
            "resource": "virtualDomains.pbadmWebTailorRoles",
            "type": "resource"
         },
         {
            "staticData": [],
            "name": "pagesecurity",
            "resource": "pagesecurity",
            "type": "resource"
         },
         {
            "name": "SelectPageBlock",
            "showInitially": true,
            "label": "",
            "components": [{
               "sourceModel": "pageLookup",
               "valueKey": "PID",
               "model": "selectPage",
               "placeholder": "Select...",
               "sourceParameters": {},
               "name": "selectPage",
               "labelKey": "CONSTANT_NAME",
               "label": "Page",
               "type": "select",
               "required": false,
               "onUpdate": "$editPageRoles.$load();\n$EditRolesForm.$visible=$selectPage;\n$roleName.$populateSource();\n$ApplyRolesForm.$visible=$selectPage;",
               "loadInitially": true
            }],
            "type": "block"
         },
         {
            "name": "EditRolesForm",
            "nextButtonLabel": "Next",
            "showInitially": false,
            "components": [{
               "model": "pageRoles",
               "onError": "var errorMessage =response.data.errors? response.data.errors.errorMessage: null;\nif (errorMessage&&errorMessage.indexOf(\"ORA-20000\") > -1) {\n  alert(\"An entry already exists for this page and role, cannot add a duplicate\", {type:\"error\"});\n} else {\n  alert(errorMessage?errorMessage:response.data, {type:\"error\"});\n}",
               "submit": "gridsubmit",
               "pageSize": 5,
               "onSave": "",
               "label": "Edit Roles for selected page",
               "type": "grid",
               "allowModify": true,
               "allowDelete": true,
               "allowReload": true,
               "name": "editPageRoles",
               "parameters": {"PAGE_ID": "$selectPage"},
               "allowNew": true,
               "components": [
                  {
                     "model": "ROLE_NAME",
                     "placeholder": "Select unique role...",
                     "labelKey": "DESCRIPTION",
                     "sourceParameters": {},
                     "label": "Role",
                     "onUpdate": "",
                     "type": "select",
                     "sourceModel": "webTailorRolesLookup",
                     "valueKey": "CODE",
                     "name": "roleName",
                     "value": "",
                     "documentation": "Should have some way to forbid selecting existing roles for this domain...",
                     "required": true,
                     "loadInitially": true
                  },
                  {
                     "model": "PAGE_ID",
                     "name": "pageID",
                     "value": "$selectPage",
                     "type": "hidden",
                     "loadInitially": true
                  },
                  {
                     "model": "ALLOW",
                     "name": "allow",
                     "value": "1",
                     "booleanTrueValue": "1",
                     "label": "Allow Access",
                     "type": "boolean",
                     "onUpdate": "",
                     "readonly": false,
                     "loadInitially": true,
                     "booleanFalseValue": "0"
                  }
               ],
               "loadInitially": false,
               "onSaveSuccess": "var saveAction = \"saved\";\n\nif (response.hasOwnProperty(\"id\") && !_.findWhere($editPageRolesDS.data,     {ROLE_NAME: response.ROLE_NAME}))\n  {\n    saveAction = \"deleted\";\n  }\nalert( \"Page role \" + response.ROLE_NAME + \" \" + saveAction,{type:\"success\", flash:true});"
            }],
            "type": "form"
         },
         {
            "submit": "",
            "name": "ApplyRolesForm",
            "nextButtonLabel": "",
            "submitLabel": "",
            "showInitially": false,
            "components": [{
               "onClick": "console.log('Apply pressed');\n$pagesecurity.$post({pageId:$selectPage});",
               "name": "applyRolesButton",
               "label": "Apply page roles",
               "type": "button"
            }],
            "type": "form"
         }
      ],
      "type": "page"
   },
   "constantName": "pbadm.PageRoles"
}