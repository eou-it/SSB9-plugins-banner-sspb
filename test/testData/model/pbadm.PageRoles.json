{
      "type": "page",
      "name": "PageRoles",
      "components": [
            {
                  "name": "pageRoles",
                  "type": "resource",
                  "binding": "rest",
                  "resource": "virtualDomains.pbadmPageRoles"
            },
            {
                  "name": "pageLookup",
                  "type": "resource",
                  "binding": "rest",
                  "resource": "virtualDomains.pbadmPageLookup"
            },
            {
                  "name": "webTailorRolesLookup",
                  "type": "resource",
                  "binding": "rest",
                  "resource": "virtualDomains.pbadmWebTailorRoles"
            },
            {
                  "name": "pagesecurity",
                  "type": "resource",
                  "binding": "rest",
                  "resource": "pagesecurity"
            },
            {
                  "name": "SelectPageBlock",
                  "type": "block",
                  "label": "",
                  "showInitially": true,
                  "components": [
                        {
                              "name": "selectPage",
                              "type": "select",
                              "labelKey": "CONSTANT_NAME",
                              "valueKey": "PID",
                              "label": "Page",
                              "sourceModel": "pageLookup",
                              "sourceParameters": {},
                              "sourceValue": [],
                              "model": "selectPage",
                              "onUpdate": "$editPageRoles.$load();\n$EditRolesForm.$visible=$selectPage;\n$roleName.$populateSource();\n$ApplyRolesForm.$visible=$selectPage;",
                              "required": false,
                              "placeholder": "Select..."
                        }
                  ]
            },
            {
                  "name": "EditRolesForm",
                  "type": "form",
                  "showInitially": false,
                  "components": [
                        {
                              "name": "editPageRoles",
                              "type": "grid",
                              "model": "pageRoles",
                              "label": "Edit Roles for selected page",
                              "parameters": {
                                    "PAGE_ID": "$selectPage"
                              },
                              "allowNew": true,
                              "allowModify": true,
                              "allowDelete": true,
                              "allowReload": true,
                              "pageSize": 5,
                              "components": [
                                    {
                                          "name": "roleName",
                                          "type": "select",
                                          "labelKey": "DESCRIPTION",
                                          "valueKey": "CODE",
                                          "documentation": "Should have some way to forbid selecting existing roles for this domain...",
                                          "label": "Role",
                                          "sourceModel": "webTailorRolesLookup",
                                          "sourceParameters": {},
                                          "sourceValue": [],
                                          "model": "ROLE_NAME",
                                          "onUpdate": "",
                                          "required": true,
                                          "placeholder": "Select unique role...",
                                          "value": ""
                                    },
                                    {
                                          "name": "pageID",
                                          "type": "hidden",
                                          "value": "$selectPage",
                                          "model": "PAGE_ID"
                                    },
                                    {
                                          "name": "allow",
                                          "type": "boolean",
                                          "label": "Allow Access",
                                          "value": "1",
                                          "booleanTrueValue": "1",
                                          "booleanFalseValue": "0",
                                          "readonly": false,
                                          "model": "ALLOW",
                                          "onUpdate": ""
                                    }
                              ],
                              "submit": "gridsubmit"
                        }
                  ],
                  "nextButtonLabel": "Next"
            },
            {
                  "name": "ApplyRolesForm",
                  "type": "form",
                  "nextButtonLabel": "",
                  "showInitially": false,
                  "components": [
                        {
                              "name": "psdata",
                              "type": "data",
                              "model": "pagesecurity",
                              "parameters": {},
                              "loadInitially": false
                        },
                        {
                              "name": "applyRolesButton",
                              "type": "button",
                              "label": "Apply page roles",
                              "onClick": "console.log('Apply pressed');\nvar item={pageId:$selectPage};\n$psdataDS.data=[];\n$psdataDS.add( item);\n$psdataDS.save();"
                        },
                        {
                              "name": "Status",
                              "type": "display",
                              "label": "Form Dirty",
                              "value": "$EditRolesForm.#dirty"
                        },
                        {
                              "name": "Status2",
                              "type": "display",
                              "label": "Page Roles Dirty",
                              "value": "$editPageRolesDS.dirty()"
                        }
                  ],
                  "submitLabel": "",
                  "submit": ""
            }
      ],
      "documentation": "Associate Roles with a Page",
      "title": "Associate Roles with a Page",
      "scriptingLanguage": "JavaScript",
      "label": "Page Roles"
}